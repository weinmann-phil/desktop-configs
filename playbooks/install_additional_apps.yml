# Install applications and resources without git or package managers
- name: Whoami
  ansible.builtin.command: whoami
  become: yes
  become_user: mnv1c
  register: local_user

- name: Ensure ZSH folder exists
  ansible.builtin.stat:
    path: "/home/{{ local_user.stdout }}/.oh-my-zsh"
  register: zsh_base

- name: Install OH-MY-ZSH
  ansible.builtin.shell: 'sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"'
  when: not zsh_base.stat.exists
  become: yes
  become_user: "{{ local_user.stdout }}"
  become_method: sudo


# https://github.com/AdaCore/ada_language_server/releases/download/26.0.202502240/als-26.0.202502240-linux-x64.tar.gz 
- name: Download ADA Language Server
  ansible.builtin.get_url:
    url: https://github.com/AdaCore/ada_language_server/releases/download/26.0.202502240/als-26.0.202502240-linux-x64.tar.gz
    dest: /home/{{ local_user.stdout }}/Downloads/als-linux-x64.tar.gz
    owner: "{{ local_user.stdout }}"
    mode: '0755'

- name: Extract ADA Language Server
  ansible.builtin.unarchive:
    src: /home/{{ local_user.stdout }}/Downloads/als-linux-x64.tar.gz
    dest: /home/{{ local_user.stdout }}/Downloads

- name: "Move ADA Language Server binary to /user/bin"
  ansible.builtin.copy:
    src: /home/{{ local_user.stdout }}/Downloads/integration/vscode/ada/x64/linux/ada_language_server
    dest: /usr/bin

- name: Clean Download Folder
  ansible.builtin.file:
    path: "{{ item }}"
    state: absent
    recurse: yes
  with_fileglob:
    - "/home/{{ local_user.stdout }}/Downloads/*"

- name: Ensure Hack Fonts Exist
  ansible.builtin.stat:
    path: /home/{{ local_user.stdout }}/.local/share/fonts/HackNerdFont-Regular.ttf
  register: nerd_font

- name: Download Hack Nerd Fonts
  ansible.builtin.get_url:
    url: https://github.com/ryanoasis/nerd-fonts/blob/master/patched-fonts/Hack/Regular/HackNerdFont-Regular.ttf
    dest: /home/{{ local_user.stdout }}/.local/share/fonts/HackNerdFont-Regular.ttf
    owner: "{{ local_user.stdout }}"
    mode: 0755
  when: not nerd_font.stat.exists

